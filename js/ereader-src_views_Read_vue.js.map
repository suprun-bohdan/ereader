{"version":3,"file":"ereader-src_views_Read_vue.js?v=f9d847d83318af57b2ee","mappings":"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","sources":["webpack:///ereader/src/views/Read.vue","webpack:///ereader/src/components/EpubViewer.vue","webpack://ereader/./src/components/EpubViewer.vue?6d36","webpack://ereader/./src/components/EpubViewer.vue?d82e","webpack:///ereader/src/components/PdfViewer.vue","webpack://ereader/./src/components/PdfViewer.vue?79c2","webpack://ereader/./src/components/PdfViewer.vue?c570","webpack://ereader/./src/views/Read.vue?636c","webpack://ereader/./src/views/Read.vue?038f","webpack:///ereader/src/components/EpubViewer.vue?vue&type=style&index=0&id=8cf22e98&scoped=true&lang=css","webpack:///ereader/src/components/PdfViewer.vue?vue&type=style&index=0&id=0f2e5dd0&scoped=true&lang=css","webpack:///ereader/src/views/Read.vue?vue&type=style&index=0&id=7465632c&scoped=true&lang=css"],"sourcesContent":["<template>\n\t<div class=\"ereader-read\">\n\t\t<header v-if=\"!isMobile\" class=\"ereader-read__header\">\n\t\t\t<router-link :to=\"{ name: 'Library' }\" class=\"ereader-read__back\">{{ t('ereader', 'Back to library') }}</router-link>\n\t\t</header>\n\t\t<div class=\"ereader-read__area\">\n\t\t\t<div v-if=\"error\" class=\"ereader-read__error\">{{ error }}</div>\n\t\t\t<div v-else-if=\"!isEpub && loadingPdf\" class=\"ereader-read__loading\">{{ t('ereader', 'Loading…') }}</div>\n\t\t\t<EpubViewer v-else-if=\"isEpub\" :url=\"streamUrl\" />\n\t\t\t<PdfViewer v-else-if=\"pdfBlob\" :blob=\"pdfBlob\" />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getStreamUrl, getStreamBlob } from '../router/api'\nimport { translate as t } from '@nextcloud/l10n'\nimport EpubViewer from '../components/EpubViewer.vue'\nimport PdfViewer from '../components/PdfViewer.vue'\n\nconst MIME_EPUB = 'application/epub+zip'\nconst MOBILE_BREAKPOINT = 768\n\nexport default {\n\tname: 'Read',\n\tcomponents: { EpubViewer, PdfViewer },\n\tprops: {\n\t\tfileId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\terror: '',\n\t\t\tloadingPdf: false,\n\t\t\tpdfBlob: null,\n\t\t\twindowWidth: typeof window !== 'undefined' ? window.innerWidth : 1024,\n\t\t}\n\t},\n\tcomputed: {\n\t\tstreamUrl() {\n\t\t\treturn getStreamUrl(Number(this.fileId))\n\t\t},\n\t\tisEpub() {\n\t\t\treturn this.$route.query?.mime === MIME_EPUB\n\t\t},\n\t\tisMobile() {\n\t\t\treturn this.windowWidth <= MOBILE_BREAKPOINT\n\t\t},\n\t},\n\tasync mounted() {\n\t\twindow.addEventListener('resize', this.onResize)\n\t\tif (this.isEpub) return\n\t\tthis.loadingPdf = true\n\t\tthis.error = ''\n\t\ttry {\n\t\t\tthis.pdfBlob = await getStreamBlob(Number(this.fileId))\n\t\t} catch (e) {\n\t\t\tthis.error = e.response?.status === 403\n\t\t\t\t? t('ereader', 'Access denied. Please refresh the page and try again.')\n\t\t\t\t: (e.message || t('ereader', 'Failed to load the file.'))\n\t\t} finally {\n\t\t\tthis.loadingPdf = false\n\t\t}\n\t},\n\tbeforeUnmount() {\n\t\twindow.removeEventListener('resize', this.onResize)\n\t\tthis.pdfBlob = null\n\t},\n\tmethods: {\n\t\tt,\n\t\tonResize() {\n\t\t\tthis.windowWidth = window.innerWidth\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n.ereader-read {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n\tmin-height: 0;\n\twidth: 100%;\n\tmax-width: 100vw;\n\tbox-sizing: border-box;\n\toverflow: hidden;\n}\n.ereader-read__header {\n\tflex-shrink: 0;\n\tpadding: 0.5rem 1rem;\n\tbackground: var(--ereader-action-bar);\n\tcolor: var(--ereader-primary-text);\n\tborder-bottom: 1px solid var(--ereader-border);\n}\n.ereader-read__back {\n\tcolor: inherit;\n\ttext-decoration: none;\n\tfont-weight: 500;\n}\n.ereader-read__back:hover {\n\ttext-decoration: underline;\n}\n.ereader-read__area {\n\tflex: 1;\n\tposition: relative;\n\tmin-height: 0;\n\twidth: 100%;\n\toverflow: hidden;\n}\n.ereader-read__error,\n.ereader-read__loading {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--ereader-text-secondary);\n}\n.ereader-read__error {\n\tcolor: var(--ereader-error);\n}\n</style>\n","<template>\n\t<div class=\"epub-viewer\">\n\t\t<div ref=\"viewerEl\" class=\"epub-viewer__area\"></div>\n\t\t<div v-if=\"loading\" class=\"epub-viewer__loading\">{{ t('ereader', 'Loading…') }}</div>\n\t\t<div v-else-if=\"error\" class=\"epub-viewer__error\">{{ error }}</div>\n\t</div>\n</template>\n\n<script>\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'EpubViewer',\n\tprops: {\n\t\turl: { type: String, required: true },\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloading: true,\n\t\t\terror: '',\n\t\t\trendition: null,\n\t\t\tbook: null,\n\t\t}\n\t},\n\tasync mounted() {\n\t\ttry {\n\t\t\tconst { default: ePub } = await import('epubjs')\n\t\t\tthis.book = ePub(this.url)\n\t\t\tawait this.book.ready\n\t\t\tthis.rendition = this.book.renderTo(this.$refs.viewerEl, {\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '100%',\n\t\t\t\tspread: 'none',\n\t\t\t})\n\t\t\tawait this.rendition.display()\n\t\t\tthis.loading = false\n\t\t} catch (e) {\n\t\t\tthis.error = e.message || this.t('ereader', 'Failed to load book')\n\t\t\tthis.loading = false\n\t\t}\n\t},\n\tbeforeUnmount() {\n\t\tif (this.rendition) {\n\t\t\tthis.rendition.destroy()\n\t\t}\n\t\tif (this.book) {\n\t\t\tthis.book.destroy()\n\t\t}\n\t},\n\tmethods: {\n\t\tt,\n\t},\n}\n</script>\n\n<style scoped>\n.epub-viewer {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n}\n.epub-viewer__area {\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--color-main-background, #fff);\n}\n.epub-viewer__loading,\n.epub-viewer__error {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n}\n.epub-viewer__error {\n\tcolor: var(--color-error, #c00);\n}\n</style>\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./EpubViewer.vue?vue&type=style&index=0&id=8cf22e98&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./EpubViewer.vue?vue&type=style&index=0&id=8cf22e98&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render } from \"./EpubViewer.vue?vue&type=template&id=8cf22e98&scoped=true\"\nimport script from \"./EpubViewer.vue?vue&type=script&lang=js\"\nexport * from \"./EpubViewer.vue?vue&type=script&lang=js\"\n\nimport \"./EpubViewer.vue?vue&type=style&index=0&id=8cf22e98&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8cf22e98\"]])\n\nexport default __exports__","<template>\n\t<div class=\"pdf-viewer\">\n\t\t<header v-if=\"!loading && !error\" class=\"pdf-viewer__toolbar\">\n\t\t\t<div class=\"pdf-viewer__toolbar-group\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"pdf-viewer__btn\"\n\t\t\t\t\t:title=\"t('ereader', 'Zoom out')\"\n\t\t\t\t\t:disabled=\"scaleFactor <= minScale\"\n\t\t\t\t\t@click=\"zoomOut\"\n\t\t\t\t>\n\t\t\t\t\t<svg class=\"pdf-viewer__icon\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\">\n\t\t\t\t\t\t<path d=\"M19 13H5v-2h14v2z\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<span class=\"pdf-viewer__scale\">{{ scalePercent }}%</span>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"pdf-viewer__btn\"\n\t\t\t\t\t:title=\"t('ereader', 'Zoom in')\"\n\t\t\t\t\t:disabled=\"scaleFactor >= maxScale\"\n\t\t\t\t\t@click=\"zoomIn\"\n\t\t\t\t>\n\t\t\t\t\t<svg class=\"pdf-viewer__icon\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\">\n\t\t\t\t\t\t<path d=\"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclass=\"pdf-viewer__btn pdf-viewer__btn--text\"\n\t\t\t\t:title=\"t('ereader', 'Fit to width')\"\n\t\t\t\t@click=\"fitWidth\"\n\t\t\t>\n\t\t\t\t{{ t('ereader', 'Fit width') }}\n\t\t\t</button>\n\t\t\t<div class=\"pdf-viewer__toolbar-group pdf-viewer__toolbar-group--page\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"pdf-viewer__btn\"\n\t\t\t\t\t:title=\"t('ereader', 'Previous page')\"\n\t\t\t\t\t:disabled=\"currentPage <= 1\"\n\t\t\t\t\t@click=\"goToPage(currentPage - 1)\"\n\t\t\t\t>\n\t\t\t\t\t<svg class=\"pdf-viewer__icon\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\">\n\t\t\t\t\t\t<path d=\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<span class=\"pdf-viewer__page-indicator\">\n\t\t\t\t\t{{ t('ereader', 'Page') }} {{ currentPage }} / {{ numPages }}\n\t\t\t\t</span>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"pdf-viewer__btn\"\n\t\t\t\t\t:title=\"t('ereader', 'Next page')\"\n\t\t\t\t\t:disabled=\"currentPage >= numPages\"\n\t\t\t\t\t@click=\"goToPage(currentPage + 1)\"\n\t\t\t\t>\n\t\t\t\t\t<svg class=\"pdf-viewer__icon\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\">\n\t\t\t\t\t\t<path d=\"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</header>\n\t\t<div ref=\"scrollEl\" class=\"pdf-viewer__scroll\" @scroll=\"onScroll\">\n\t\t\t<div ref=\"containerEl\" class=\"pdf-viewer__container\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"pageNum in numPages\"\n\t\t\t\t\t:key=\"pageNum\"\n\t\t\t\t\t:ref=\"(el) => setPageWrapRef(el, pageNum)\"\n\t\t\t\t\tclass=\"pdf-viewer__page-wrap\"\n\t\t\t\t\t:data-page=\"pageNum\"\n\t\t\t\t>\n\t\t\t\t\t<canvas\n\t\t\t\t\t\t:ref=\"(el) => setCanvasRef(el, pageNum)\"\n\t\t\t\t\t\tclass=\"pdf-viewer__page\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"loading\" class=\"pdf-viewer__loading\">{{ t('ereader', 'Loading…') }}</div>\n\t\t<div v-else-if=\"error\" class=\"pdf-viewer__error\">{{ error }}</div>\n\t</div>\n</template>\n\n<script>\nimport { markRaw } from 'vue'\nimport { translate as t } from '@nextcloud/l10n'\nimport { generateUrl } from '@nextcloud/router'\nimport * as pdfjsLib from 'pdfjs-dist'\n\nif (typeof window !== 'undefined' && !pdfjsLib.GlobalWorkerOptions.workerSrc) {\n\tpdfjsLib.GlobalWorkerOptions.workerSrc = generateUrl('/apps/ereader/js/pdf.worker.js')\n}\n\nconst MIN_SCALE = 0.5\nconst MAX_SCALE = 3\nconst ZOOM_STEP = 0.25\n\nexport default {\n\tname: 'PdfViewer',\n\tprops: {\n\t\tblob: {\n\t\t\ttype: Blob,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloading: true,\n\t\t\terror: '',\n\t\t\tnumPages: 0,\n\t\t\tpdfDoc: null,\n\t\t\tcanvasRefs: {},\n\t\t\tpageWrapRefs: {},\n\t\t\tscaleFactor: 1,\n\t\t\tcurrentPage: 1,\n\t\t\tminScale: MIN_SCALE,\n\t\t\tmaxScale: MAX_SCALE,\n\t\t\tpixelRatio: typeof window !== 'undefined' ? Math.min(window.devicePixelRatio || 1, 2) : 1,\n\t\t}\n\t},\n\tcomputed: {\n\t\tscalePercent() {\n\t\t\treturn Math.round(this.scaleFactor * 100)\n\t\t},\n\t},\n\tasync mounted() {\n\t\tawait this.loadPdf()\n\t},\n\tbeforeUnmount() {\n\t\tthis.canvasRefs = {}\n\t\tthis.pageWrapRefs = {}\n\t\tif (this.$refs.scrollEl) {\n\t\t\tthis.$refs.scrollEl.removeEventListener('scroll', this.onScroll)\n\t\t}\n\t\tif (this.pdfDoc && typeof this.pdfDoc.destroy === 'function') {\n\t\t\ttry {\n\t\t\t\tthis.pdfDoc.destroy()\n\t\t\t} catch (_) {}\n\t\t\tthis.pdfDoc = null\n\t\t}\n\t},\n\tmethods: {\n\t\tt,\n\t\tsetCanvasRef(el, pageNum) {\n\t\t\tif (el) this.canvasRefs[pageNum] = el\n\t\t},\n\t\tsetPageWrapRef(el, pageNum) {\n\t\t\tif (el) this.pageWrapRefs[pageNum] = el\n\t\t},\n\t\tzoomIn() {\n\t\t\tthis.scaleFactor = Math.min(this.maxScale, this.scaleFactor + ZOOM_STEP)\n\t\t\tthis.$nextTick(() => this.renderAllPages())\n\t\t},\n\t\tzoomOut() {\n\t\t\tthis.scaleFactor = Math.max(this.minScale, this.scaleFactor - ZOOM_STEP)\n\t\t\tthis.$nextTick(() => this.renderAllPages())\n\t\t},\n\t\tfitWidth() {\n\t\t\tthis.scaleFactor = 1\n\t\t\tthis.$nextTick(() => this.renderAllPages())\n\t\t},\n\t\tgoToPage(pageNum) {\n\t\t\tconst n = Math.max(1, Math.min(this.numPages, pageNum))\n\t\t\tconst el = this.pageWrapRefs[n]\n\t\t\tif (el && this.$refs.scrollEl) {\n\t\t\t\tel.scrollIntoView({ behavior: 'smooth', block: 'start' })\n\t\t\t}\n\t\t\tthis.currentPage = n\n\t\t},\n\t\tonScroll() {\n\t\t\tconst scrollEl = this.$refs.scrollEl\n\t\t\tif (!scrollEl || this.numPages === 0) return\n\t\t\tconst scrollTop = scrollEl.scrollTop\n\t\t\tconst viewportMid = scrollTop + scrollEl.clientHeight / 2\n\t\t\tlet page = 1\n\t\t\tfor (let n = 1; n <= this.numPages; n++) {\n\t\t\t\tconst wrap = this.pageWrapRefs[n]\n\t\t\t\tif (!wrap) continue\n\t\t\t\tconst top = wrap.offsetTop\n\t\t\t\tconst bottom = top + wrap.offsetHeight\n\t\t\t\tif (viewportMid >= top && viewportMid <= bottom) {\n\t\t\t\t\tpage = n\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tif (viewportMid < bottom) {\n\t\t\t\t\tpage = n\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tpage = n\n\t\t\t}\n\t\t\tthis.currentPage = page\n\t\t},\n\t\tasync loadPdf() {\n\t\t\tthis.loading = true\n\t\t\tthis.error = ''\n\t\t\ttry {\n\t\t\t\tconst data = await this.blob.arrayBuffer()\n\t\t\t\tconst doc = await pdfjsLib.getDocument({ data }).promise\n\t\t\t\tthis.pdfDoc = markRaw(doc)\n\t\t\t\tthis.numPages = this.pdfDoc.numPages\n\t\t\t\tthis.loading = false\n\t\t\t\tawait this.$nextTick()\n\t\t\t\tawait this.$nextTick()\n\t\t\t\tawait this.renderAllPages()\n\t\t\t\tif (this.$refs.scrollEl) {\n\t\t\t\t\tthis.$refs.scrollEl.addEventListener('scroll', this.onScroll, { passive: true })\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tthis.error = e.message || t('ereader', 'Failed to load PDF')\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t\tasync renderAllPages() {\n\t\t\tif (!this.pdfDoc || !this.$refs.containerEl) return\n\t\t\tconst container = this.$refs.containerEl\n\t\t\tconst baseWidth = container.clientWidth || 800\n\t\t\tfor (let n = 1; n <= this.numPages; n++) {\n\t\t\t\tconst canvas = this.canvasRefs[n]\n\t\t\t\tif (!canvas) continue\n\t\t\t\tconst page = await this.pdfDoc.getPage(n)\n\t\t\t\tconst baseScale = baseWidth / page.getViewport({ scale: 1 }).width\n\t\t\t\tconst effectiveScale = baseScale * this.scaleFactor * this.pixelRatio\n\t\t\t\tconst viewport = page.getViewport({ scale: effectiveScale })\n\t\t\t\tcanvas.width = viewport.width\n\t\t\t\tcanvas.height = viewport.height\n\t\t\t\tcanvas.style.width = (viewport.width / this.pixelRatio) + 'px'\n\t\t\t\tcanvas.style.height = (viewport.height / this.pixelRatio) + 'px'\n\t\t\t\tconst ctx = canvas.getContext('2d')\n\t\t\t\tawait page.render({\n\t\t\t\t\tcanvasContext: ctx,\n\t\t\t\t\tviewport,\n\t\t\t\t}).promise\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style scoped>\n.pdf-viewer {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground: var(--ereader-surface);\n}\n\n.pdf-viewer__toolbar {\n\tflex-shrink: 0;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\talign-items: center;\n\tgap: 0.5rem 1rem;\n\tpadding: 0.5rem 0.75rem;\n\tbackground: var(--ereader-action-bar);\n\tcolor: var(--ereader-primary-text);\n\tborder-bottom: 1px solid var(--ereader-border);\n}\n\n.pdf-viewer__toolbar-group {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 0.25rem;\n}\n\n.pdf-viewer__toolbar-group--page {\n\tmargin-left: auto;\n}\n\n.pdf-viewer__btn {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmin-width: 36px;\n\theight: 36px;\n\tpadding: 0 0.5rem;\n\tborder: none;\n\tborder-radius: var(--ereader-radius-sm);\n\tbackground: transparent;\n\tcolor: inherit;\n\tcursor: pointer;\n\ttransition: background 0.15s;\n}\n\n.pdf-viewer__btn:hover:not(:disabled) {\n\tbackground: rgba(255, 255, 255, 0.2);\n}\n\n.pdf-viewer__btn:disabled {\n\topacity: 0.5;\n\tcursor: not-allowed;\n}\n\n.pdf-viewer__btn--text {\n\tfont-size: 0.875rem;\n}\n\n.pdf-viewer__icon {\n\twidth: 24px;\n\theight: 24px;\n}\n\n.pdf-viewer__scale {\n\tmin-width: 3.5em;\n\tfont-size: 0.875rem;\n\ttext-align: center;\n}\n\n.pdf-viewer__page-indicator {\n\tfont-size: 0.875rem;\n\twhite-space: nowrap;\n}\n\n.pdf-viewer__scroll {\n\tflex: 1;\n\tmin-height: 0;\n\toverflow: auto;\n\tscroll-behavior: smooth;\n}\n\n.pdf-viewer__container {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tpadding: 1rem 0;\n\tgap: 1rem;\n}\n\n.pdf-viewer__page-wrap {\n\tdisplay: block;\n}\n\n.pdf-viewer__page {\n\tdisplay: block;\n\tmax-width: 100%;\n\theight: auto;\n\tbox-shadow: var(--ereader-card-shadow);\n}\n\n.pdf-viewer__loading,\n.pdf-viewer__error {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--ereader-text-secondary);\n\tbackground: var(--ereader-surface);\n}\n\n.pdf-viewer__error {\n\tcolor: var(--ereader-error);\n}\n</style>\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./PdfViewer.vue?vue&type=style&index=0&id=0f2e5dd0&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./PdfViewer.vue?vue&type=style&index=0&id=0f2e5dd0&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render } from \"./PdfViewer.vue?vue&type=template&id=0f2e5dd0&scoped=true\"\nimport script from \"./PdfViewer.vue?vue&type=script&lang=js\"\nexport * from \"./PdfViewer.vue?vue&type=script&lang=js\"\n\nimport \"./PdfViewer.vue?vue&type=style&index=0&id=0f2e5dd0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0f2e5dd0\"]])\n\nexport default __exports__","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./Read.vue?vue&type=style&index=0&id=7465632c&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[11].use[0]!./Read.vue?vue&type=style&index=0&id=7465632c&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render } from \"./Read.vue?vue&type=template&id=7465632c&scoped=true\"\nimport script from \"./Read.vue?vue&type=script&lang=js\"\nexport * from \"./Read.vue?vue&type=script&lang=js\"\n\nimport \"./Read.vue?vue&type=style&index=0&id=7465632c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7465632c\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.epub-viewer[data-v-8cf22e98] {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n}\n.epub-viewer__area[data-v-8cf22e98] {\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--color-main-background, #fff);\n}\n.epub-viewer__loading[data-v-8cf22e98],\n.epub-viewer__error[data-v-8cf22e98] {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n}\n.epub-viewer__error[data-v-8cf22e98] {\n\tcolor: var(--color-error, #c00);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/EpubViewer.vue\"],\"names\":[],\"mappings\":\";AAwDA;CACC,kBAAkB;CAClB,WAAW;CACX,YAAY;AACb;AACA;CACC,WAAW;CACX,YAAY;CACZ,8CAA8C;AAC/C;AACA;;CAEC,kBAAkB;CAClB,QAAQ;CACR,aAAa;CACb,mBAAmB;CACnB,uBAAuB;CACvB,aAAa;CACb,kBAAkB;AACnB;AACA;CACC,+BAA+B;AAChC\",\"sourcesContent\":[\"<template>\\n\\t<div class=\\\"epub-viewer\\\">\\n\\t\\t<div ref=\\\"viewerEl\\\" class=\\\"epub-viewer__area\\\"></div>\\n\\t\\t<div v-if=\\\"loading\\\" class=\\\"epub-viewer__loading\\\">{{ t('ereader', 'Loading…') }}</div>\\n\\t\\t<div v-else-if=\\\"error\\\" class=\\\"epub-viewer__error\\\">{{ error }}</div>\\n\\t</div>\\n</template>\\n\\n<script>\\nimport { translate as t } from '@nextcloud/l10n'\\n\\nexport default {\\n\\tname: 'EpubViewer',\\n\\tprops: {\\n\\t\\turl: { type: String, required: true },\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\tloading: true,\\n\\t\\t\\terror: '',\\n\\t\\t\\trendition: null,\\n\\t\\t\\tbook: null,\\n\\t\\t}\\n\\t},\\n\\tasync mounted() {\\n\\t\\ttry {\\n\\t\\t\\tconst { default: ePub } = await import('epubjs')\\n\\t\\t\\tthis.book = ePub(this.url)\\n\\t\\t\\tawait this.book.ready\\n\\t\\t\\tthis.rendition = this.book.renderTo(this.$refs.viewerEl, {\\n\\t\\t\\t\\twidth: '100%',\\n\\t\\t\\t\\theight: '100%',\\n\\t\\t\\t\\tspread: 'none',\\n\\t\\t\\t})\\n\\t\\t\\tawait this.rendition.display()\\n\\t\\t\\tthis.loading = false\\n\\t\\t} catch (e) {\\n\\t\\t\\tthis.error = e.message || this.t('ereader', 'Failed to load book')\\n\\t\\t\\tthis.loading = false\\n\\t\\t}\\n\\t},\\n\\tbeforeUnmount() {\\n\\t\\tif (this.rendition) {\\n\\t\\t\\tthis.rendition.destroy()\\n\\t\\t}\\n\\t\\tif (this.book) {\\n\\t\\t\\tthis.book.destroy()\\n\\t\\t}\\n\\t},\\n\\tmethods: {\\n\\t\\tt,\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n.epub-viewer {\\n\\tposition: relative;\\n\\twidth: 100%;\\n\\theight: 100%;\\n}\\n.epub-viewer__area {\\n\\twidth: 100%;\\n\\theight: 100%;\\n\\tbackground: var(--color-main-background, #fff);\\n}\\n.epub-viewer__loading,\\n.epub-viewer__error {\\n\\tposition: absolute;\\n\\tinset: 0;\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\tpadding: 2rem;\\n\\ttext-align: center;\\n}\\n.epub-viewer__error {\\n\\tcolor: var(--color-error, #c00);\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.pdf-viewer[data-v-0f2e5dd0] {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground: var(--ereader-surface);\n}\n.pdf-viewer__toolbar[data-v-0f2e5dd0] {\n\tflex-shrink: 0;\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\talign-items: center;\n\tgap: 0.5rem 1rem;\n\tpadding: 0.5rem 0.75rem;\n\tbackground: var(--ereader-action-bar);\n\tcolor: var(--ereader-primary-text);\n\tborder-bottom: 1px solid var(--ereader-border);\n}\n.pdf-viewer__toolbar-group[data-v-0f2e5dd0] {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 0.25rem;\n}\n.pdf-viewer__toolbar-group--page[data-v-0f2e5dd0] {\n\tmargin-left: auto;\n}\n.pdf-viewer__btn[data-v-0f2e5dd0] {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmin-width: 36px;\n\theight: 36px;\n\tpadding: 0 0.5rem;\n\tborder: none;\n\tborder-radius: var(--ereader-radius-sm);\n\tbackground: transparent;\n\tcolor: inherit;\n\tcursor: pointer;\n\ttransition: background 0.15s;\n}\n.pdf-viewer__btn[data-v-0f2e5dd0]:hover:not(:disabled) {\n\tbackground: rgba(255, 255, 255, 0.2);\n}\n.pdf-viewer__btn[data-v-0f2e5dd0]:disabled {\n\topacity: 0.5;\n\tcursor: not-allowed;\n}\n.pdf-viewer__btn--text[data-v-0f2e5dd0] {\n\tfont-size: 0.875rem;\n}\n.pdf-viewer__icon[data-v-0f2e5dd0] {\n\twidth: 24px;\n\theight: 24px;\n}\n.pdf-viewer__scale[data-v-0f2e5dd0] {\n\tmin-width: 3.5em;\n\tfont-size: 0.875rem;\n\ttext-align: center;\n}\n.pdf-viewer__page-indicator[data-v-0f2e5dd0] {\n\tfont-size: 0.875rem;\n\twhite-space: nowrap;\n}\n.pdf-viewer__scroll[data-v-0f2e5dd0] {\n\tflex: 1;\n\tmin-height: 0;\n\toverflow: auto;\n\tscroll-behavior: smooth;\n}\n.pdf-viewer__container[data-v-0f2e5dd0] {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tpadding: 1rem 0;\n\tgap: 1rem;\n}\n.pdf-viewer__page-wrap[data-v-0f2e5dd0] {\n\tdisplay: block;\n}\n.pdf-viewer__page[data-v-0f2e5dd0] {\n\tdisplay: block;\n\tmax-width: 100%;\n\theight: auto;\n\tbox-shadow: var(--ereader-card-shadow);\n}\n.pdf-viewer__loading[data-v-0f2e5dd0],\n.pdf-viewer__error[data-v-0f2e5dd0] {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--ereader-text-secondary);\n\tbackground: var(--ereader-surface);\n}\n.pdf-viewer__error[data-v-0f2e5dd0] {\n\tcolor: var(--ereader-error);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/PdfViewer.vue\"],\"names\":[],\"mappings\":\";AAiPA;CACC,kBAAkB;CAClB,WAAW;CACX,YAAY;CACZ,aAAa;CACb,sBAAsB;CACtB,kCAAkC;AACnC;AAEA;CACC,cAAc;CACd,aAAa;CACb,eAAe;CACf,mBAAmB;CACnB,gBAAgB;CAChB,uBAAuB;CACvB,qCAAqC;CACrC,kCAAkC;CAClC,8CAA8C;AAC/C;AAEA;CACC,aAAa;CACb,mBAAmB;CACnB,YAAY;AACb;AAEA;CACC,iBAAiB;AAClB;AAEA;CACC,oBAAoB;CACpB,mBAAmB;CACnB,uBAAuB;CACvB,eAAe;CACf,YAAY;CACZ,iBAAiB;CACjB,YAAY;CACZ,uCAAuC;CACvC,uBAAuB;CACvB,cAAc;CACd,eAAe;CACf,4BAA4B;AAC7B;AAEA;CACC,oCAAoC;AACrC;AAEA;CACC,YAAY;CACZ,mBAAmB;AACpB;AAEA;CACC,mBAAmB;AACpB;AAEA;CACC,WAAW;CACX,YAAY;AACb;AAEA;CACC,gBAAgB;CAChB,mBAAmB;CACnB,kBAAkB;AACnB;AAEA;CACC,mBAAmB;CACnB,mBAAmB;AACpB;AAEA;CACC,OAAO;CACP,aAAa;CACb,cAAc;CACd,uBAAuB;AACxB;AAEA;CACC,aAAa;CACb,sBAAsB;CACtB,mBAAmB;CACnB,eAAe;CACf,SAAS;AACV;AAEA;CACC,cAAc;AACf;AAEA;CACC,cAAc;CACd,eAAe;CACf,YAAY;CACZ,sCAAsC;AACvC;AAEA;;CAEC,kBAAkB;CAClB,QAAQ;CACR,aAAa;CACb,mBAAmB;CACnB,uBAAuB;CACvB,aAAa;CACb,kBAAkB;CAClB,oCAAoC;CACpC,kCAAkC;AACnC;AAEA;CACC,2BAA2B;AAC5B\",\"sourcesContent\":[\"<template>\\n\\t<div class=\\\"pdf-viewer\\\">\\n\\t\\t<header v-if=\\\"!loading && !error\\\" class=\\\"pdf-viewer__toolbar\\\">\\n\\t\\t\\t<div class=\\\"pdf-viewer__toolbar-group\\\">\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\ttype=\\\"button\\\"\\n\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__btn\\\"\\n\\t\\t\\t\\t\\t:title=\\\"t('ereader', 'Zoom out')\\\"\\n\\t\\t\\t\\t\\t:disabled=\\\"scaleFactor <= minScale\\\"\\n\\t\\t\\t\\t\\t@click=\\\"zoomOut\\\"\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<svg class=\\\"pdf-viewer__icon\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\" aria-hidden=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<path d=\\\"M19 13H5v-2h14v2z\\\"/>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t<span class=\\\"pdf-viewer__scale\\\">{{ scalePercent }}%</span>\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\ttype=\\\"button\\\"\\n\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__btn\\\"\\n\\t\\t\\t\\t\\t:title=\\\"t('ereader', 'Zoom in')\\\"\\n\\t\\t\\t\\t\\t:disabled=\\\"scaleFactor >= maxScale\\\"\\n\\t\\t\\t\\t\\t@click=\\\"zoomIn\\\"\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<svg class=\\\"pdf-viewer__icon\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\" aria-hidden=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<path d=\\\"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\\\"/>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t</div>\\n\\t\\t\\t<button\\n\\t\\t\\t\\ttype=\\\"button\\\"\\n\\t\\t\\t\\tclass=\\\"pdf-viewer__btn pdf-viewer__btn--text\\\"\\n\\t\\t\\t\\t:title=\\\"t('ereader', 'Fit to width')\\\"\\n\\t\\t\\t\\t@click=\\\"fitWidth\\\"\\n\\t\\t\\t>\\n\\t\\t\\t\\t{{ t('ereader', 'Fit width') }}\\n\\t\\t\\t</button>\\n\\t\\t\\t<div class=\\\"pdf-viewer__toolbar-group pdf-viewer__toolbar-group--page\\\">\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\ttype=\\\"button\\\"\\n\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__btn\\\"\\n\\t\\t\\t\\t\\t:title=\\\"t('ereader', 'Previous page')\\\"\\n\\t\\t\\t\\t\\t:disabled=\\\"currentPage <= 1\\\"\\n\\t\\t\\t\\t\\t@click=\\\"goToPage(currentPage - 1)\\\"\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<svg class=\\\"pdf-viewer__icon\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\" aria-hidden=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<path d=\\\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\\\"/>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t<span class=\\\"pdf-viewer__page-indicator\\\">\\n\\t\\t\\t\\t\\t{{ t('ereader', 'Page') }} {{ currentPage }} / {{ numPages }}\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\ttype=\\\"button\\\"\\n\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__btn\\\"\\n\\t\\t\\t\\t\\t:title=\\\"t('ereader', 'Next page')\\\"\\n\\t\\t\\t\\t\\t:disabled=\\\"currentPage >= numPages\\\"\\n\\t\\t\\t\\t\\t@click=\\\"goToPage(currentPage + 1)\\\"\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<svg class=\\\"pdf-viewer__icon\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\" aria-hidden=\\\"true\\\">\\n\\t\\t\\t\\t\\t\\t<path d=\\\"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\\\"/>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t</div>\\n\\t\\t</header>\\n\\t\\t<div ref=\\\"scrollEl\\\" class=\\\"pdf-viewer__scroll\\\" @scroll=\\\"onScroll\\\">\\n\\t\\t\\t<div ref=\\\"containerEl\\\" class=\\\"pdf-viewer__container\\\">\\n\\t\\t\\t\\t<div\\n\\t\\t\\t\\t\\tv-for=\\\"pageNum in numPages\\\"\\n\\t\\t\\t\\t\\t:key=\\\"pageNum\\\"\\n\\t\\t\\t\\t\\t:ref=\\\"(el) => setPageWrapRef(el, pageNum)\\\"\\n\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__page-wrap\\\"\\n\\t\\t\\t\\t\\t:data-page=\\\"pageNum\\\"\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<canvas\\n\\t\\t\\t\\t\\t\\t:ref=\\\"(el) => setCanvasRef(el, pageNum)\\\"\\n\\t\\t\\t\\t\\t\\tclass=\\\"pdf-viewer__page\\\"\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t\\t<div v-if=\\\"loading\\\" class=\\\"pdf-viewer__loading\\\">{{ t('ereader', 'Loading…') }}</div>\\n\\t\\t<div v-else-if=\\\"error\\\" class=\\\"pdf-viewer__error\\\">{{ error }}</div>\\n\\t</div>\\n</template>\\n\\n<script>\\nimport { markRaw } from 'vue'\\nimport { translate as t } from '@nextcloud/l10n'\\nimport { generateUrl } from '@nextcloud/router'\\nimport * as pdfjsLib from 'pdfjs-dist'\\n\\nif (typeof window !== 'undefined' && !pdfjsLib.GlobalWorkerOptions.workerSrc) {\\n\\tpdfjsLib.GlobalWorkerOptions.workerSrc = generateUrl('/apps/ereader/js/pdf.worker.js')\\n}\\n\\nconst MIN_SCALE = 0.5\\nconst MAX_SCALE = 3\\nconst ZOOM_STEP = 0.25\\n\\nexport default {\\n\\tname: 'PdfViewer',\\n\\tprops: {\\n\\t\\tblob: {\\n\\t\\t\\ttype: Blob,\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\tloading: true,\\n\\t\\t\\terror: '',\\n\\t\\t\\tnumPages: 0,\\n\\t\\t\\tpdfDoc: null,\\n\\t\\t\\tcanvasRefs: {},\\n\\t\\t\\tpageWrapRefs: {},\\n\\t\\t\\tscaleFactor: 1,\\n\\t\\t\\tcurrentPage: 1,\\n\\t\\t\\tminScale: MIN_SCALE,\\n\\t\\t\\tmaxScale: MAX_SCALE,\\n\\t\\t\\tpixelRatio: typeof window !== 'undefined' ? Math.min(window.devicePixelRatio || 1, 2) : 1,\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tscalePercent() {\\n\\t\\t\\treturn Math.round(this.scaleFactor * 100)\\n\\t\\t},\\n\\t},\\n\\tasync mounted() {\\n\\t\\tawait this.loadPdf()\\n\\t},\\n\\tbeforeUnmount() {\\n\\t\\tthis.canvasRefs = {}\\n\\t\\tthis.pageWrapRefs = {}\\n\\t\\tif (this.$refs.scrollEl) {\\n\\t\\t\\tthis.$refs.scrollEl.removeEventListener('scroll', this.onScroll)\\n\\t\\t}\\n\\t\\tif (this.pdfDoc && typeof this.pdfDoc.destroy === 'function') {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tthis.pdfDoc.destroy()\\n\\t\\t\\t} catch (_) {}\\n\\t\\t\\tthis.pdfDoc = null\\n\\t\\t}\\n\\t},\\n\\tmethods: {\\n\\t\\tt,\\n\\t\\tsetCanvasRef(el, pageNum) {\\n\\t\\t\\tif (el) this.canvasRefs[pageNum] = el\\n\\t\\t},\\n\\t\\tsetPageWrapRef(el, pageNum) {\\n\\t\\t\\tif (el) this.pageWrapRefs[pageNum] = el\\n\\t\\t},\\n\\t\\tzoomIn() {\\n\\t\\t\\tthis.scaleFactor = Math.min(this.maxScale, this.scaleFactor + ZOOM_STEP)\\n\\t\\t\\tthis.$nextTick(() => this.renderAllPages())\\n\\t\\t},\\n\\t\\tzoomOut() {\\n\\t\\t\\tthis.scaleFactor = Math.max(this.minScale, this.scaleFactor - ZOOM_STEP)\\n\\t\\t\\tthis.$nextTick(() => this.renderAllPages())\\n\\t\\t},\\n\\t\\tfitWidth() {\\n\\t\\t\\tthis.scaleFactor = 1\\n\\t\\t\\tthis.$nextTick(() => this.renderAllPages())\\n\\t\\t},\\n\\t\\tgoToPage(pageNum) {\\n\\t\\t\\tconst n = Math.max(1, Math.min(this.numPages, pageNum))\\n\\t\\t\\tconst el = this.pageWrapRefs[n]\\n\\t\\t\\tif (el && this.$refs.scrollEl) {\\n\\t\\t\\t\\tel.scrollIntoView({ behavior: 'smooth', block: 'start' })\\n\\t\\t\\t}\\n\\t\\t\\tthis.currentPage = n\\n\\t\\t},\\n\\t\\tonScroll() {\\n\\t\\t\\tconst scrollEl = this.$refs.scrollEl\\n\\t\\t\\tif (!scrollEl || this.numPages === 0) return\\n\\t\\t\\tconst scrollTop = scrollEl.scrollTop\\n\\t\\t\\tconst viewportMid = scrollTop + scrollEl.clientHeight / 2\\n\\t\\t\\tlet page = 1\\n\\t\\t\\tfor (let n = 1; n <= this.numPages; n++) {\\n\\t\\t\\t\\tconst wrap = this.pageWrapRefs[n]\\n\\t\\t\\t\\tif (!wrap) continue\\n\\t\\t\\t\\tconst top = wrap.offsetTop\\n\\t\\t\\t\\tconst bottom = top + wrap.offsetHeight\\n\\t\\t\\t\\tif (viewportMid >= top && viewportMid <= bottom) {\\n\\t\\t\\t\\t\\tpage = n\\n\\t\\t\\t\\t\\tbreak\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (viewportMid < bottom) {\\n\\t\\t\\t\\t\\tpage = n\\n\\t\\t\\t\\t\\tbreak\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tpage = n\\n\\t\\t\\t}\\n\\t\\t\\tthis.currentPage = page\\n\\t\\t},\\n\\t\\tasync loadPdf() {\\n\\t\\t\\tthis.loading = true\\n\\t\\t\\tthis.error = ''\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tconst data = await this.blob.arrayBuffer()\\n\\t\\t\\t\\tconst doc = await pdfjsLib.getDocument({ data }).promise\\n\\t\\t\\t\\tthis.pdfDoc = markRaw(doc)\\n\\t\\t\\t\\tthis.numPages = this.pdfDoc.numPages\\n\\t\\t\\t\\tthis.loading = false\\n\\t\\t\\t\\tawait this.$nextTick()\\n\\t\\t\\t\\tawait this.$nextTick()\\n\\t\\t\\t\\tawait this.renderAllPages()\\n\\t\\t\\t\\tif (this.$refs.scrollEl) {\\n\\t\\t\\t\\t\\tthis.$refs.scrollEl.addEventListener('scroll', this.onScroll, { passive: true })\\n\\t\\t\\t\\t}\\n\\t\\t\\t} catch (e) {\\n\\t\\t\\t\\tthis.error = e.message || t('ereader', 'Failed to load PDF')\\n\\t\\t\\t\\tthis.loading = false\\n\\t\\t\\t}\\n\\t\\t},\\n\\t\\tasync renderAllPages() {\\n\\t\\t\\tif (!this.pdfDoc || !this.$refs.containerEl) return\\n\\t\\t\\tconst container = this.$refs.containerEl\\n\\t\\t\\tconst baseWidth = container.clientWidth || 800\\n\\t\\t\\tfor (let n = 1; n <= this.numPages; n++) {\\n\\t\\t\\t\\tconst canvas = this.canvasRefs[n]\\n\\t\\t\\t\\tif (!canvas) continue\\n\\t\\t\\t\\tconst page = await this.pdfDoc.getPage(n)\\n\\t\\t\\t\\tconst baseScale = baseWidth / page.getViewport({ scale: 1 }).width\\n\\t\\t\\t\\tconst effectiveScale = baseScale * this.scaleFactor * this.pixelRatio\\n\\t\\t\\t\\tconst viewport = page.getViewport({ scale: effectiveScale })\\n\\t\\t\\t\\tcanvas.width = viewport.width\\n\\t\\t\\t\\tcanvas.height = viewport.height\\n\\t\\t\\t\\tcanvas.style.width = (viewport.width / this.pixelRatio) + 'px'\\n\\t\\t\\t\\tcanvas.style.height = (viewport.height / this.pixelRatio) + 'px'\\n\\t\\t\\t\\tconst ctx = canvas.getContext('2d')\\n\\t\\t\\t\\tawait page.render({\\n\\t\\t\\t\\t\\tcanvasContext: ctx,\\n\\t\\t\\t\\t\\tviewport,\\n\\t\\t\\t\\t}).promise\\n\\t\\t\\t}\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n.pdf-viewer {\\n\\tposition: relative;\\n\\twidth: 100%;\\n\\theight: 100%;\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\tbackground: var(--ereader-surface);\\n}\\n\\n.pdf-viewer__toolbar {\\n\\tflex-shrink: 0;\\n\\tdisplay: flex;\\n\\tflex-wrap: wrap;\\n\\talign-items: center;\\n\\tgap: 0.5rem 1rem;\\n\\tpadding: 0.5rem 0.75rem;\\n\\tbackground: var(--ereader-action-bar);\\n\\tcolor: var(--ereader-primary-text);\\n\\tborder-bottom: 1px solid var(--ereader-border);\\n}\\n\\n.pdf-viewer__toolbar-group {\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tgap: 0.25rem;\\n}\\n\\n.pdf-viewer__toolbar-group--page {\\n\\tmargin-left: auto;\\n}\\n\\n.pdf-viewer__btn {\\n\\tdisplay: inline-flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\tmin-width: 36px;\\n\\theight: 36px;\\n\\tpadding: 0 0.5rem;\\n\\tborder: none;\\n\\tborder-radius: var(--ereader-radius-sm);\\n\\tbackground: transparent;\\n\\tcolor: inherit;\\n\\tcursor: pointer;\\n\\ttransition: background 0.15s;\\n}\\n\\n.pdf-viewer__btn:hover:not(:disabled) {\\n\\tbackground: rgba(255, 255, 255, 0.2);\\n}\\n\\n.pdf-viewer__btn:disabled {\\n\\topacity: 0.5;\\n\\tcursor: not-allowed;\\n}\\n\\n.pdf-viewer__btn--text {\\n\\tfont-size: 0.875rem;\\n}\\n\\n.pdf-viewer__icon {\\n\\twidth: 24px;\\n\\theight: 24px;\\n}\\n\\n.pdf-viewer__scale {\\n\\tmin-width: 3.5em;\\n\\tfont-size: 0.875rem;\\n\\ttext-align: center;\\n}\\n\\n.pdf-viewer__page-indicator {\\n\\tfont-size: 0.875rem;\\n\\twhite-space: nowrap;\\n}\\n\\n.pdf-viewer__scroll {\\n\\tflex: 1;\\n\\tmin-height: 0;\\n\\toverflow: auto;\\n\\tscroll-behavior: smooth;\\n}\\n\\n.pdf-viewer__container {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\talign-items: center;\\n\\tpadding: 1rem 0;\\n\\tgap: 1rem;\\n}\\n\\n.pdf-viewer__page-wrap {\\n\\tdisplay: block;\\n}\\n\\n.pdf-viewer__page {\\n\\tdisplay: block;\\n\\tmax-width: 100%;\\n\\theight: auto;\\n\\tbox-shadow: var(--ereader-card-shadow);\\n}\\n\\n.pdf-viewer__loading,\\n.pdf-viewer__error {\\n\\tposition: absolute;\\n\\tinset: 0;\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\tpadding: 2rem;\\n\\ttext-align: center;\\n\\tcolor: var(--ereader-text-secondary);\\n\\tbackground: var(--ereader-surface);\\n}\\n\\n.pdf-viewer__error {\\n\\tcolor: var(--ereader-error);\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.ereader-read[data-v-7465632c] {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n\tmin-height: 0;\n\twidth: 100%;\n\tmax-width: 100vw;\n\tbox-sizing: border-box;\n\toverflow: hidden;\n}\n.ereader-read__header[data-v-7465632c] {\n\tflex-shrink: 0;\n\tpadding: 0.5rem 1rem;\n\tbackground: var(--ereader-action-bar);\n\tcolor: var(--ereader-primary-text);\n\tborder-bottom: 1px solid var(--ereader-border);\n}\n.ereader-read__back[data-v-7465632c] {\n\tcolor: inherit;\n\ttext-decoration: none;\n\tfont-weight: 500;\n}\n.ereader-read__back[data-v-7465632c]:hover {\n\ttext-decoration: underline;\n}\n.ereader-read__area[data-v-7465632c] {\n\tflex: 1;\n\tposition: relative;\n\tmin-height: 0;\n\twidth: 100%;\n\toverflow: hidden;\n}\n.ereader-read__error[data-v-7465632c],\n.ereader-read__loading[data-v-7465632c] {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--ereader-text-secondary);\n}\n.ereader-read__error[data-v-7465632c] {\n\tcolor: var(--ereader-error);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/views/Read.vue\"],\"names\":[],\"mappings\":\";AAgFA;CACC,aAAa;CACb,sBAAsB;CACtB,YAAY;CACZ,aAAa;CACb,WAAW;CACX,gBAAgB;CAChB,sBAAsB;CACtB,gBAAgB;AACjB;AACA;CACC,cAAc;CACd,oBAAoB;CACpB,qCAAqC;CACrC,kCAAkC;CAClC,8CAA8C;AAC/C;AACA;CACC,cAAc;CACd,qBAAqB;CACrB,gBAAgB;AACjB;AACA;CACC,0BAA0B;AAC3B;AACA;CACC,OAAO;CACP,kBAAkB;CAClB,aAAa;CACb,WAAW;CACX,gBAAgB;AACjB;AACA;;CAEC,kBAAkB;CAClB,QAAQ;CACR,aAAa;CACb,mBAAmB;CACnB,uBAAuB;CACvB,aAAa;CACb,kBAAkB;CAClB,oCAAoC;AACrC;AACA;CACC,2BAA2B;AAC5B\",\"sourcesContent\":[\"<template>\\n\\t<div class=\\\"ereader-read\\\">\\n\\t\\t<header v-if=\\\"!isMobile\\\" class=\\\"ereader-read__header\\\">\\n\\t\\t\\t<router-link :to=\\\"{ name: 'Library' }\\\" class=\\\"ereader-read__back\\\">{{ t('ereader', 'Back to library') }}</router-link>\\n\\t\\t</header>\\n\\t\\t<div class=\\\"ereader-read__area\\\">\\n\\t\\t\\t<div v-if=\\\"error\\\" class=\\\"ereader-read__error\\\">{{ error }}</div>\\n\\t\\t\\t<div v-else-if=\\\"!isEpub && loadingPdf\\\" class=\\\"ereader-read__loading\\\">{{ t('ereader', 'Loading…') }}</div>\\n\\t\\t\\t<EpubViewer v-else-if=\\\"isEpub\\\" :url=\\\"streamUrl\\\" />\\n\\t\\t\\t<PdfViewer v-else-if=\\\"pdfBlob\\\" :blob=\\\"pdfBlob\\\" />\\n\\t\\t</div>\\n\\t</div>\\n</template>\\n\\n<script>\\nimport { getStreamUrl, getStreamBlob } from '../router/api'\\nimport { translate as t } from '@nextcloud/l10n'\\nimport EpubViewer from '../components/EpubViewer.vue'\\nimport PdfViewer from '../components/PdfViewer.vue'\\n\\nconst MIME_EPUB = 'application/epub+zip'\\nconst MOBILE_BREAKPOINT = 768\\n\\nexport default {\\n\\tname: 'Read',\\n\\tcomponents: { EpubViewer, PdfViewer },\\n\\tprops: {\\n\\t\\tfileId: {\\n\\t\\t\\ttype: [String, Number],\\n\\t\\t\\trequired: true,\\n\\t\\t},\\n\\t},\\n\\tdata() {\\n\\t\\treturn {\\n\\t\\t\\terror: '',\\n\\t\\t\\tloadingPdf: false,\\n\\t\\t\\tpdfBlob: null,\\n\\t\\t\\twindowWidth: typeof window !== 'undefined' ? window.innerWidth : 1024,\\n\\t\\t}\\n\\t},\\n\\tcomputed: {\\n\\t\\tstreamUrl() {\\n\\t\\t\\treturn getStreamUrl(Number(this.fileId))\\n\\t\\t},\\n\\t\\tisEpub() {\\n\\t\\t\\treturn this.$route.query?.mime === MIME_EPUB\\n\\t\\t},\\n\\t\\tisMobile() {\\n\\t\\t\\treturn this.windowWidth <= MOBILE_BREAKPOINT\\n\\t\\t},\\n\\t},\\n\\tasync mounted() {\\n\\t\\twindow.addEventListener('resize', this.onResize)\\n\\t\\tif (this.isEpub) return\\n\\t\\tthis.loadingPdf = true\\n\\t\\tthis.error = ''\\n\\t\\ttry {\\n\\t\\t\\tthis.pdfBlob = await getStreamBlob(Number(this.fileId))\\n\\t\\t} catch (e) {\\n\\t\\t\\tthis.error = e.response?.status === 403\\n\\t\\t\\t\\t? t('ereader', 'Access denied. Please refresh the page and try again.')\\n\\t\\t\\t\\t: (e.message || t('ereader', 'Failed to load the file.'))\\n\\t\\t} finally {\\n\\t\\t\\tthis.loadingPdf = false\\n\\t\\t}\\n\\t},\\n\\tbeforeUnmount() {\\n\\t\\twindow.removeEventListener('resize', this.onResize)\\n\\t\\tthis.pdfBlob = null\\n\\t},\\n\\tmethods: {\\n\\t\\tt,\\n\\t\\tonResize() {\\n\\t\\t\\tthis.windowWidth = window.innerWidth\\n\\t\\t},\\n\\t},\\n}\\n</script>\\n\\n<style scoped>\\n.ereader-read {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\theight: 100%;\\n\\tmin-height: 0;\\n\\twidth: 100%;\\n\\tmax-width: 100vw;\\n\\tbox-sizing: border-box;\\n\\toverflow: hidden;\\n}\\n.ereader-read__header {\\n\\tflex-shrink: 0;\\n\\tpadding: 0.5rem 1rem;\\n\\tbackground: var(--ereader-action-bar);\\n\\tcolor: var(--ereader-primary-text);\\n\\tborder-bottom: 1px solid var(--ereader-border);\\n}\\n.ereader-read__back {\\n\\tcolor: inherit;\\n\\ttext-decoration: none;\\n\\tfont-weight: 500;\\n}\\n.ereader-read__back:hover {\\n\\ttext-decoration: underline;\\n}\\n.ereader-read__area {\\n\\tflex: 1;\\n\\tposition: relative;\\n\\tmin-height: 0;\\n\\twidth: 100%;\\n\\toverflow: hidden;\\n}\\n.ereader-read__error,\\n.ereader-read__loading {\\n\\tposition: absolute;\\n\\tinset: 0;\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\tpadding: 2rem;\\n\\ttext-align: center;\\n\\tcolor: var(--ereader-text-secondary);\\n}\\n.ereader-read__error {\\n\\tcolor: var(--ereader-error);\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["class","ref","name","props","url","type","String","required","data","loading","error","rendition","book","mounted","default","ePub","this","ready","renderTo","$refs","viewerEl","width","height","spread","display","e","message","t","beforeUnmount","destroy","methods","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","$data","_hoisted_3","_toDisplayString","$options","_hoisted_4","window","pdfjsLib","workerSrc","generateUrl","blob","Blob","numPages","pdfDoc","canvasRefs","pageWrapRefs","scaleFactor","currentPage","minScale","maxScale","pixelRatio","Math","min","devicePixelRatio","computed","scalePercent","round","loadPdf","scrollEl","removeEventListener","onScroll","_","setCanvasRef","el","pageNum","setPageWrapRef","zoomIn","$nextTick","renderAllPages","zoomOut","max","fitWidth","goToPage","n","scrollIntoView","behavior","block","viewportMid","scrollTop","clientHeight","page","wrap","top","offsetTop","bottom","offsetHeight","arrayBuffer","doc","promise","markRaw","addEventListener","passive","containerEl","baseWidth","clientWidth","canvas","getPage","effectiveScale","getViewport","scale","viewport","style","ctx","getContext","render","canvasContext","components","EpubViewer","PdfViewer","title","disabled","onClick","_cache","args","viewBox","fill","d","_hoisted_5","_hoisted_7","_hoisted_8","$event","_hoisted_10","_hoisted_12","_Fragment","_renderList","key","_hoisted_14","_hoisted_15","fileId","Number","loadingPdf","pdfBlob","windowWidth","innerWidth","streamUrl","getStreamUrl","isEpub","$route","query","mime","isMobile","onResize","getStreamBlob","response","status","_createVNode","_component_router_link","to","_createBlock","_component_EpubViewer","_component_PdfViewer","___CSS_LOADER_EXPORT___","push","module","id"],"ignoreList":[],"sourceRoot":""}