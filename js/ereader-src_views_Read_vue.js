"use strict";(self.webpackChunkereader=self.webpackChunkereader||[]).push([["src_views_Read_vue"],{2706(e,t,r){r.d(t,{A:()=>d});var n=r(1354),a=r.n(n),i=r(6314),o=r.n(i)()(a());o.push([e.id,"\n.epub-viewer[data-v-8cf22e98] {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n}\n.epub-viewer__area[data-v-8cf22e98] {\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--color-main-background, #fff);\n}\n.epub-viewer__loading[data-v-8cf22e98],\n.epub-viewer__error[data-v-8cf22e98] {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n}\n.epub-viewer__error[data-v-8cf22e98] {\n\tcolor: var(--color-error, #c00);\n}\n","",{version:3,sources:["webpack://./src/components/EpubViewer.vue"],names:[],mappings:";AAwDA;CACC,kBAAkB;CAClB,WAAW;CACX,YAAY;AACb;AACA;CACC,WAAW;CACX,YAAY;CACZ,8CAA8C;AAC/C;AACA;;CAEC,kBAAkB;CAClB,QAAQ;CACR,aAAa;CACb,mBAAmB;CACnB,uBAAuB;CACvB,aAAa;CACb,kBAAkB;AACnB;AACA;CACC,+BAA+B;AAChC",sourcesContent:["<template>\n\t<div class=\"epub-viewer\">\n\t\t<div ref=\"viewerEl\" class=\"epub-viewer__area\"></div>\n\t\t<div v-if=\"loading\" class=\"epub-viewer__loading\">{{ t('ereader', 'Loading…') }}</div>\n\t\t<div v-else-if=\"error\" class=\"epub-viewer__error\">{{ error }}</div>\n\t</div>\n</template>\n\n<script>\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'EpubViewer',\n\tprops: {\n\t\turl: { type: String, required: true },\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloading: true,\n\t\t\terror: '',\n\t\t\trendition: null,\n\t\t\tbook: null,\n\t\t}\n\t},\n\tasync mounted() {\n\t\ttry {\n\t\t\tconst { default: ePub } = await import('epubjs')\n\t\t\tthis.book = ePub(this.url)\n\t\t\tawait this.book.ready\n\t\t\tthis.rendition = this.book.renderTo(this.$refs.viewerEl, {\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '100%',\n\t\t\t\tspread: 'none',\n\t\t\t})\n\t\t\tawait this.rendition.display()\n\t\t\tthis.loading = false\n\t\t} catch (e) {\n\t\t\tthis.error = e.message || this.t('ereader', 'Failed to load book')\n\t\t\tthis.loading = false\n\t\t}\n\t},\n\tbeforeUnmount() {\n\t\tif (this.rendition) {\n\t\t\tthis.rendition.destroy()\n\t\t}\n\t\tif (this.book) {\n\t\t\tthis.book.destroy()\n\t\t}\n\t},\n\tmethods: {\n\t\tt,\n\t},\n}\n<\/script>\n\n<style scoped>\n.epub-viewer {\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n}\n.epub-viewer__area {\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--color-main-background, #fff);\n}\n.epub-viewer__loading,\n.epub-viewer__error {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n}\n.epub-viewer__error {\n\tcolor: var(--color-error, #c00);\n}\n</style>\n"],sourceRoot:""}]);const d=o},7348(e,t,r){r.d(t,{A:()=>d});var n=r(1354),a=r.n(n),i=r(6314),o=r.n(i)()(a());o.push([e.id,"\n.ereader-read[data-v-3009dd8e] {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100vh;\n}\n.ereader-read__header[data-v-3009dd8e] {\n\tpadding: 0.5rem 1rem;\n\tbackground: var(--color-background-hover, #f5f5f5);\n\tborder-bottom: 1px solid var(--color-border, #ddd);\n}\n.ereader-read__back[data-v-3009dd8e] {\n\tcolor: var(--color-primary, #0082c9);\n\ttext-decoration: none;\n}\n.ereader-read__back[data-v-3009dd8e]:hover {\n\ttext-decoration: underline;\n}\n.ereader-read__area[data-v-3009dd8e] {\n\tflex: 1;\n\tposition: relative;\n\tmin-height: 0;\n}\n.ereader-read__iframe[data-v-3009dd8e] {\n\tposition: absolute;\n\tinset: 0;\n\twidth: 100%;\n\theight: 100%;\n\tborder: none;\n}\n.ereader-read__error[data-v-3009dd8e] {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--color-error, #c00);\n}\n","",{version:3,sources:["webpack://./src/views/Read.vue"],names:[],mappings:";AAiDA;CACC,aAAa;CACb,sBAAsB;CACtB,aAAa;AACd;AACA;CACC,oBAAoB;CACpB,kDAAkD;CAClD,kDAAkD;AACnD;AACA;CACC,oCAAoC;CACpC,qBAAqB;AACtB;AACA;CACC,0BAA0B;AAC3B;AACA;CACC,OAAO;CACP,kBAAkB;CAClB,aAAa;AACd;AACA;CACC,kBAAkB;CAClB,QAAQ;CACR,WAAW;CACX,YAAY;CACZ,YAAY;AACb;AACA;CACC,kBAAkB;CAClB,QAAQ;CACR,aAAa;CACb,mBAAmB;CACnB,uBAAuB;CACvB,aAAa;CACb,kBAAkB;CAClB,+BAA+B;AAChC",sourcesContent:['<template>\n\t<div class="ereader-read">\n\t\t<header class="ereader-read__header">\n\t\t\t<router-link :to="{ name: \'Library\' }" class="ereader-read__back">{{ t(\'ereader\', \'Back to library\') }}</router-link>\n\t\t</header>\n\t\t<div class="ereader-read__area">\n\t\t\t<div v-if="error" class="ereader-read__error">{{ error }}</div>\n\t\t\t<EpubViewer v-else-if="isEpub" :url="streamUrl" />\n\t\t\t<iframe v-else :src="streamUrl" class="ereader-read__iframe" title="Book content"></iframe>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getStreamUrl } from \'../router/api\'\nimport { translate as t } from \'@nextcloud/l10n\'\nimport EpubViewer from \'../components/EpubViewer.vue\'\n\nconst MIME_EPUB = \'application/epub+zip\'\n\nexport default {\n\tname: \'Read\',\n\tcomponents: { EpubViewer },\n\tprops: {\n\t\tfileId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\terror: \'\',\n\t\t}\n\t},\n\tcomputed: {\n\t\tstreamUrl() {\n\t\t\treturn getStreamUrl(Number(this.fileId))\n\t\t},\n\t\tisEpub() {\n\t\t\treturn this.$route.query?.mime === MIME_EPUB\n\t\t},\n\t},\n\tmethods: {\n\t\tt,\n\t},\n}\n<\/script>\n\n<style scoped>\n.ereader-read {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100vh;\n}\n.ereader-read__header {\n\tpadding: 0.5rem 1rem;\n\tbackground: var(--color-background-hover, #f5f5f5);\n\tborder-bottom: 1px solid var(--color-border, #ddd);\n}\n.ereader-read__back {\n\tcolor: var(--color-primary, #0082c9);\n\ttext-decoration: none;\n}\n.ereader-read__back:hover {\n\ttext-decoration: underline;\n}\n.ereader-read__area {\n\tflex: 1;\n\tposition: relative;\n\tmin-height: 0;\n}\n.ereader-read__iframe {\n\tposition: absolute;\n\tinset: 0;\n\twidth: 100%;\n\theight: 100%;\n\tborder: none;\n}\n.ereader-read__error {\n\tposition: absolute;\n\tinset: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 2rem;\n\ttext-align: center;\n\tcolor: var(--color-error, #c00);\n}\n</style>\n'],sourceRoot:""}]);const d=o},9537(e,t,r){r.r(t),r.d(t,{default:()=>D});var n=r(641),a=r(33);const i={class:"ereader-read"},o={class:"ereader-read__header"},d={class:"ereader-read__area"},s={key:0,class:"ereader-read__error"},l=["src"];var A=r(249),c=r(3334);const u={class:"epub-viewer"},C={ref:"viewerEl",class:"epub-viewer__area"},p={key:0,class:"epub-viewer__loading"},v={key:1,class:"epub-viewer__error"};const b={name:"EpubViewer",props:{url:{type:String,required:!0}},data:()=>({loading:!0,error:"",rendition:null,book:null}),async mounted(){try{const{default:e}=await r.e("vendors-node_modules_epubjs_src_index_js").then(r.bind(r,1684));this.book=e(this.url),await this.book.ready,this.rendition=this.book.renderTo(this.$refs.viewerEl,{width:"100%",height:"100%",spread:"none"}),await this.rendition.display(),this.loading=!1}catch(e){this.error=e.message||this.t("ereader","Failed to load book"),this.loading=!1}},beforeUnmount(){this.rendition&&this.rendition.destroy(),this.book&&this.book.destroy()},methods:{t:c.Tl}};var h=r(5072),m=r.n(h),_=r(7825),f=r.n(_),k=r(7659),g=r.n(k),B=r(5056),w=r.n(B),y=r(540),E=r.n(y),x=r(1113),U=r.n(x),I=r(2706),X={};X.styleTagTransform=U(),X.setAttributes=w(),X.insert=g().bind(null,"head"),X.domAPI=f(),X.insertStyleElement=E();m()(I.A,X);I.A&&I.A.locals&&I.A.locals;var q=r(6262);const R={name:"Read",components:{EpubViewer:(0,q.A)(b,[["render",function(e,t,r,i,o,d){return(0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",C,null,512),o.loading?((0,n.uX)(),(0,n.CE)("div",p,(0,a.v_)(d.t("ereader","Loading…")),1)):o.error?((0,n.uX)(),(0,n.CE)("div",v,(0,a.v_)(o.error),1)):(0,n.Q3)("",!0)])}],["__scopeId","data-v-8cf22e98"]])},props:{fileId:{type:[String,Number],required:!0}},data:()=>({error:""}),computed:{streamUrl(){return(0,A.Wq)(Number(this.fileId))},isEpub(){return"application/epub+zip"===this.$route.query?.mime}},methods:{t:c.Tl}};var V=r(7348),W={};W.styleTagTransform=U(),W.setAttributes=w(),W.insert=g().bind(null,"head"),W.domAPI=f(),W.insertStyleElement=E();m()(V.A,W);V.A&&V.A.locals&&V.A.locals;const D=(0,q.A)(R,[["render",function(e,t,r,A,c,u){const C=(0,n.g2)("router-link"),p=(0,n.g2)("EpubViewer");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("header",o,[(0,n.bF)(C,{to:{name:"Library"},class:"ereader-read__back"},{default:(0,n.k6)(()=>[(0,n.eW)((0,a.v_)(u.t("ereader","Back to library")),1)]),_:1})]),(0,n.Lk)("div",d,[c.error?((0,n.uX)(),(0,n.CE)("div",s,(0,a.v_)(c.error),1)):u.isEpub?((0,n.uX)(),(0,n.Wv)(p,{key:1,url:u.streamUrl},null,8,["url"])):((0,n.uX)(),(0,n.CE)("iframe",{key:2,src:u.streamUrl,class:"ereader-read__iframe",title:"Book content"},null,8,l))])])}],["__scopeId","data-v-3009dd8e"]])}}]);
//# sourceMappingURL=ereader-src_views_Read_vue.js.map?v=43c58f68f90386f849e9