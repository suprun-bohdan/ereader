"use strict";(self.webpackChunkereader=self.webpackChunkereader||[]).push([["src_views_Setup_vue"],{3896(t,e,r){r.r(e),r.d(e,{default:()=>W});var n=r(641),a=r(33);const o={class:"ereader-setup"},s={class:"ereader-setup__card"},d={class:"ereader-setup__title"},i={class:"ereader-setup__desc"},l={key:0,class:"ereader-setup__loading"},A={key:0,class:"ereader-setup__error ereader-setup__error--top"},p={class:"ereader-setup__breadcrumb"},C=["onClick"],u={class:"ereader-setup__actions"},c=["disabled"],f={class:"ereader-setup__folders"},_={class:"ereader-setup__folder ereader-setup__folder--root"},m=["onClick"],b={key:0,class:"ereader-setup__empty"},h={key:2,class:"ereader-setup__error"};var g=r(249),v=r(3334);const y={name:"Setup",data:()=>({path:"",folders:[],loading:!0,saving:!1,error:""}),computed:{pathParts(){return this.path?this.path.split("/").filter(Boolean):[]}},watch:{path:{immediate:!0,handler(){this.loadFolders()}}},methods:{t:v.Tl,async loadFolders(){this.loading=!0,this.error="";try{const t=await(0,g.aq)(this.path);t&&"object"==typeof t?(this.folders=Array.isArray(t.folders)?t.folders:Array.isArray(t)?t:[],this.error=t.error?String(t.error):""):(this.folders=Array.isArray(t)?t:[],this.error=t&&t.error?String(t.error):"")}catch(t){const e=t.response,r=e?.data,n=r&&"object"==typeof r&&(r.error||r.message)?r.error||r.message:e?.data?String(e.data):t.message;this.error=n||this.t("ereader","Failed to load folders"),this.folders=[]}finally{this.loading=!1}},async selectCurrent(){this.saving=!0,this.error="";try{await(0,g.Nk)(this.path),this.$router.replace({name:"Library"})}catch(t){this.error=t.message||this.t("ereader","Failed to save")}finally{this.saving=!1}}}};var B=r(5072),k=r.n(B),x=r(7825),w=r.n(x),L=r(7659),S=r.n(L),F=r(5056),z=r.n(F),E=r(540),X=r.n(E),j=r(1113),Y=r.n(j),P=r(7008),U={};U.styleTagTransform=Y(),U.setAttributes=z(),U.insert=S().bind(null,"head"),U.domAPI=w(),U.insertStyleElement=X();k()(P.A,U);P.A&&P.A.locals&&P.A.locals;const W=(0,r(6262).A)(y,[["render",function(t,e,r,g,v,y){return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",s,[(0,n.Lk)("h1",d,(0,a.v_)(y.t("ereader","Choose your books folder")),1),(0,n.Lk)("p",i,(0,a.v_)(y.t("ereader","Select the folder where your EPUB and PDF books are stored. You can also scan all your files.")),1),v.loading?((0,n.uX)(),(0,n.CE)("div",l,(0,a.v_)(y.t("ereader","Loading‚Ä¶")),1)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[v.error?((0,n.uX)(),(0,n.CE)("p",A,(0,a.v_)(v.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",p,[(0,n.Lk)("button",{type:"button",class:"ereader-setup__breadcrumb-item",onClick:e[0]||(e[0]=t=>v.path="")},(0,a.v_)(y.t("ereader","Home")),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(y.pathParts,(t,r)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:r},[e[3]||(e[3]=(0,n.Lk)("span",{class:"ereader-setup__breadcrumb-sep"},"/",-1)),(0,n.Lk)("button",{type:"button",class:"ereader-setup__breadcrumb-item",onClick:t=>v.path=y.pathParts.slice(0,r+1).join("/")},(0,a.v_)(t),9,C)],64))),128))]),(0,n.Lk)("div",u,[(0,n.Lk)("button",{type:"button",class:"ereader-setup__btn primary",disabled:v.saving,onClick:e[1]||(e[1]=(...t)=>y.selectCurrent&&y.selectCurrent(...t))},(0,a.v_)(""===v.path?y.t("ereader","Scan all my files"):y.t("ereader","Use this folder")),9,c)]),(0,n.Lk)("ul",f,[(0,n.Lk)("li",_,[(0,n.Lk)("button",{type:"button",class:"ereader-setup__folder-btn ereader-setup__folder-btn--root",onClick:e[2]||(e[2]=(...t)=>y.selectCurrent&&y.selectCurrent(...t))},[e[4]||(e[4]=(0,n.Lk)("span",{class:"ereader-setup__folder-icon"},"üìÅ",-1)),(0,n.eW)(" "+(0,a.v_)(""===v.path?y.t("ereader","My files ‚Äî use as books folder"):y.t("ereader","Use this folder as books location")),1)])]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(v.folders,t=>((0,n.uX)(),(0,n.CE)("li",{key:t.path||t.name,class:"ereader-setup__folder"},[(0,n.Lk)("button",{type:"button",class:"ereader-setup__folder-btn",onClick:e=>v.path=t.path||""},[e[5]||(e[5]=(0,n.Lk)("span",{class:"ereader-setup__folder-icon"},"üìÅ",-1)),(0,n.eW)(" "+(0,a.v_)(t.name),1)],8,m)]))),128)),0!==v.folders.length||v.loading?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("li",b,(0,a.v_)(y.t("ereader","No subfolders in this folder. Use the option above to select this location.")),1))])],64)),v.error?((0,n.uX)(),(0,n.CE)("p",h,(0,a.v_)(v.error),1)):(0,n.Q3)("",!0)])])}],["__scopeId","data-v-368fdfe0"]])},7008(t,e,r){r.d(e,{A:()=>d});var n=r(1354),a=r.n(n),o=r(6314),s=r.n(o)()(a());s.push([t.id,"\n.ereader-setup[data-v-368fdfe0] {\n\tpadding: 2rem;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: flex-start;\n\tmin-height: 80vh;\n}\n.ereader-setup__card[data-v-368fdfe0] {\n\tbackground: var(--color-main-background, #fff);\n\tborder-radius: var(--border-radius-large, 8px);\n\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n\tpadding: 2rem;\n\tmax-width: 480px;\n\twidth: 100%;\n}\n.ereader-setup__title[data-v-368fdfe0] {\n\tmargin: 0 0 0.5rem;\n\tfont-size: 1.5rem;\n}\n.ereader-setup__desc[data-v-368fdfe0] {\n\tcolor: var(--color-text-lighter, #666);\n\tmargin: 0 0 1.5rem;\n}\n.ereader-setup__breadcrumb[data-v-368fdfe0] {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\talign-items: center;\n\tgap: 0.25rem;\n\tmargin-bottom: 1rem;\n\tfont-size: 0.9rem;\n}\n.ereader-setup__breadcrumb-item[data-v-368fdfe0] {\n\tbackground: none;\n\tborder: none;\n\tcolor: var(--color-primary, #0082c9);\n\tcursor: pointer;\n\tpadding: 0.2rem 0.4rem;\n\tborder-radius: 4px;\n}\n.ereader-setup__breadcrumb-item[data-v-368fdfe0]:hover {\n\ttext-decoration: underline;\n}\n.ereader-setup__breadcrumb-sep[data-v-368fdfe0] {\n\tcolor: var(--color-text-lighter, #999);\n}\n.ereader-setup__actions[data-v-368fdfe0] {\n\tmargin-bottom: 1rem;\n}\n.ereader-setup__btn[data-v-368fdfe0] {\n\tpadding: 0.5rem 1rem;\n\tborder-radius: var(--border-radius, 4px);\n\tborder: none;\n\tcursor: pointer;\n\tfont-size: 1rem;\n}\n.ereader-setup__btn.primary[data-v-368fdfe0] {\n\tbackground: var(--color-primary, #0082c9);\n\tcolor: #fff;\n}\n.ereader-setup__btn[data-v-368fdfe0]:disabled {\n\topacity: 0.6;\n\tcursor: not-allowed;\n}\n.ereader-setup__folders[data-v-368fdfe0] {\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0;\n}\n.ereader-setup__folder[data-v-368fdfe0] {\n\tmargin: 0.25rem 0;\n}\n.ereader-setup__folder-btn[data-v-368fdfe0] {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 0.5rem;\n\twidth: 100%;\n\ttext-align: left;\n\tpadding: 0.5rem 0.75rem;\n\tbackground: var(--color-background-hover, #f5f5f5);\n\tborder: none;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tfont-size: 1rem;\n}\n.ereader-setup__folder-btn[data-v-368fdfe0]:hover {\n\tbackground: var(--color-background-dark, #e5e5e5);\n}\n.ereader-setup__folder--root[data-v-368fdfe0] {\n\tmargin-bottom: 0.5rem;\n}\n.ereader-setup__folder-btn--root[data-v-368fdfe0] {\n\tbackground: var(--color-primary-light, #e6f4ff);\n\tcolor: var(--color-primary-text, #006aa3);\n\tfont-weight: 600;\n}\n.ereader-setup__folder-btn--root[data-v-368fdfe0]:hover {\n\tbackground: var(--color-primary-hover, #cce8ff);\n}\n.ereader-setup__folder-icon[data-v-368fdfe0] {\n\tfont-size: 1.2rem;\n}\n.ereader-setup__empty[data-v-368fdfe0] {\n\tcolor: var(--color-text-lighter, #666);\n\tpadding: 0.5rem 0;\n\tfont-size: 0.9rem;\n}\n.ereader-setup__loading[data-v-368fdfe0],\n.ereader-setup__error[data-v-368fdfe0] {\n\tmargin: 1rem 0 0;\n}\n.ereader-setup__error[data-v-368fdfe0] {\n\tcolor: var(--color-error, #c00);\n}\n","",{version:3,sources:["webpack://./src/views/Setup.vue"],names:[],mappings:";AA4HA;CACC,aAAa;CACb,aAAa;CACb,uBAAuB;CACvB,uBAAuB;CACvB,gBAAgB;AACjB;AACA;CACC,8CAA8C;CAC9C,8CAA8C;CAC9C,wCAAwC;CACxC,aAAa;CACb,gBAAgB;CAChB,WAAW;AACZ;AACA;CACC,kBAAkB;CAClB,iBAAiB;AAClB;AACA;CACC,sCAAsC;CACtC,kBAAkB;AACnB;AACA;CACC,aAAa;CACb,eAAe;CACf,mBAAmB;CACnB,YAAY;CACZ,mBAAmB;CACnB,iBAAiB;AAClB;AACA;CACC,gBAAgB;CAChB,YAAY;CACZ,oCAAoC;CACpC,eAAe;CACf,sBAAsB;CACtB,kBAAkB;AACnB;AACA;CACC,0BAA0B;AAC3B;AACA;CACC,sCAAsC;AACvC;AACA;CACC,mBAAmB;AACpB;AACA;CACC,oBAAoB;CACpB,wCAAwC;CACxC,YAAY;CACZ,eAAe;CACf,eAAe;AAChB;AACA;CACC,yCAAyC;CACzC,WAAW;AACZ;AACA;CACC,YAAY;CACZ,mBAAmB;AACpB;AACA;CACC,gBAAgB;CAChB,SAAS;CACT,UAAU;AACX;AACA;CACC,iBAAiB;AAClB;AACA;CACC,aAAa;CACb,mBAAmB;CACnB,WAAW;CACX,WAAW;CACX,gBAAgB;CAChB,uBAAuB;CACvB,kDAAkD;CAClD,YAAY;CACZ,kBAAkB;CAClB,eAAe;CACf,eAAe;AAChB;AACA;CACC,iDAAiD;AAClD;AACA;CACC,qBAAqB;AACtB;AACA;CACC,+CAA+C;CAC/C,yCAAyC;CACzC,gBAAgB;AACjB;AACA;CACC,+CAA+C;AAChD;AACA;CACC,iBAAiB;AAClB;AACA;CACC,sCAAsC;CACtC,iBAAiB;CACjB,iBAAiB;AAClB;AACA;;CAEC,gBAAgB;AACjB;AACA;CACC,+BAA+B;AAChC",sourcesContent:["<template>\n\t<div class=\"ereader-setup\">\n\t\t<div class=\"ereader-setup__card\">\n\t\t\t<h1 class=\"ereader-setup__title\">{{ t('ereader', 'Choose your books folder') }}</h1>\n\t\t\t<p class=\"ereader-setup__desc\">{{ t('ereader', 'Select the folder where your EPUB and PDF books are stored. You can also scan all your files.') }}</p>\n\n\t\t\t<div v-if=\"loading\" class=\"ereader-setup__loading\">{{ t('ereader', 'Loading‚Ä¶') }}</div>\n\n\t\t\t<template v-else>\n\t\t\t\t<p v-if=\"error\" class=\"ereader-setup__error ereader-setup__error--top\">{{ error }}</p>\n\n\t\t\t\t<div class=\"ereader-setup__breadcrumb\">\n\t\t\t\t\t<button type=\"button\" class=\"ereader-setup__breadcrumb-item\" @click=\"path = ''\">\n\t\t\t\t\t\t{{ t('ereader', 'Home') }}\n\t\t\t\t\t</button>\n\t\t\t\t\t<template v-for=\"(part, i) in pathParts\" :key=\"i\">\n\t\t\t\t\t\t<span class=\"ereader-setup__breadcrumb-sep\">/</span>\n\t\t\t\t\t\t<button type=\"button\" class=\"ereader-setup__breadcrumb-item\" @click=\"path = pathParts.slice(0, i + 1).join('/')\">\n\t\t\t\t\t\t\t{{ part }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"ereader-setup__actions\">\n\t\t\t\t\t<button type=\"button\" class=\"ereader-setup__btn primary\" :disabled=\"saving\" @click=\"selectCurrent\">\n\t\t\t\t\t\t{{ path === '' ? t('ereader', 'Scan all my files') : t('ereader', 'Use this folder') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<ul class=\"ereader-setup__folders\">\n\t\t\t\t\t<li class=\"ereader-setup__folder ereader-setup__folder--root\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ereader-setup__folder-btn ereader-setup__folder-btn--root\" @click=\"selectCurrent\">\n\t\t\t\t\t\t\t<span class=\"ereader-setup__folder-icon\">üìÅ</span>\n\t\t\t\t\t\t\t{{ path === '' ? t('ereader', 'My files ‚Äî use as books folder') : t('ereader', 'Use this folder as books location') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li v-for=\"folder in folders\" :key=\"folder.path || folder.name\" class=\"ereader-setup__folder\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ereader-setup__folder-btn\" @click=\"path = folder.path || ''\">\n\t\t\t\t\t\t\t<span class=\"ereader-setup__folder-icon\">üìÅ</span>\n\t\t\t\t\t\t\t{{ folder.name }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li v-if=\"folders.length === 0 && !loading\" class=\"ereader-setup__empty\">\n\t\t\t\t\t\t{{ t('ereader', 'No subfolders in this folder. Use the option above to select this location.') }}\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</template>\n\n\t\t\t<p v-if=\"error\" class=\"ereader-setup__error\">{{ error }}</p>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getFolders, setConfig } from '../router/api'\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'Setup',\n\tdata() {\n\t\treturn {\n\t\t\tpath: '',\n\t\t\tfolders: [],\n\t\t\tloading: true,\n\t\t\tsaving: false,\n\t\t\terror: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\tpathParts() {\n\t\t\treturn this.path ? this.path.split('/').filter(Boolean) : []\n\t\t},\n\t},\n\twatch: {\n\t\tpath: {\n\t\t\timmediate: true,\n\t\t\thandler() {\n\t\t\t\tthis.loadFolders()\n\t\t\t},\n\t\t},\n\t},\n\tmethods: {\n\t\tt,\n\t\tasync loadFolders() {\n\t\t\tthis.loading = true\n\t\t\tthis.error = ''\n\t\t\ttry {\n\t\t\t\tconst data = await getFolders(this.path)\n\t\t\t\tif (data && typeof data === 'object') {\n\t\t\t\t\tthis.folders = Array.isArray(data.folders) ? data.folders : (Array.isArray(data) ? data : [])\n\t\t\t\t\tthis.error = data.error ? String(data.error) : ''\n\t\t\t\t} else {\n\t\t\t\t\tthis.folders = Array.isArray(data) ? data : []\n\t\t\t\t\tthis.error = data && data.error ? String(data.error) : ''\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconst res = e.response\n\t\t\t\tconst errBody = res?.data\n\t\t\t\tconst errMsg = (errBody && typeof errBody === 'object' && (errBody.error || errBody.message))\n\t\t\t\t\t? (errBody.error || errBody.message)\n\t\t\t\t\t: (res?.data ? String(res.data) : e.message)\n\t\t\t\tthis.error = errMsg || this.t('ereader', 'Failed to load folders')\n\t\t\t\tthis.folders = []\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t\tasync selectCurrent() {\n\t\t\tthis.saving = true\n\t\t\tthis.error = ''\n\t\t\ttry {\n\t\t\t\tawait setConfig(this.path)\n\t\t\t\tthis.$router.replace({ name: 'Library' })\n\t\t\t} catch (e) {\n\t\t\t\tthis.error = e.message || this.t('ereader', 'Failed to save')\n\t\t\t} finally {\n\t\t\t\tthis.saving = false\n\t\t\t}\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.ereader-setup {\n\tpadding: 2rem;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: flex-start;\n\tmin-height: 80vh;\n}\n.ereader-setup__card {\n\tbackground: var(--color-main-background, #fff);\n\tborder-radius: var(--border-radius-large, 8px);\n\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n\tpadding: 2rem;\n\tmax-width: 480px;\n\twidth: 100%;\n}\n.ereader-setup__title {\n\tmargin: 0 0 0.5rem;\n\tfont-size: 1.5rem;\n}\n.ereader-setup__desc {\n\tcolor: var(--color-text-lighter, #666);\n\tmargin: 0 0 1.5rem;\n}\n.ereader-setup__breadcrumb {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\talign-items: center;\n\tgap: 0.25rem;\n\tmargin-bottom: 1rem;\n\tfont-size: 0.9rem;\n}\n.ereader-setup__breadcrumb-item {\n\tbackground: none;\n\tborder: none;\n\tcolor: var(--color-primary, #0082c9);\n\tcursor: pointer;\n\tpadding: 0.2rem 0.4rem;\n\tborder-radius: 4px;\n}\n.ereader-setup__breadcrumb-item:hover {\n\ttext-decoration: underline;\n}\n.ereader-setup__breadcrumb-sep {\n\tcolor: var(--color-text-lighter, #999);\n}\n.ereader-setup__actions {\n\tmargin-bottom: 1rem;\n}\n.ereader-setup__btn {\n\tpadding: 0.5rem 1rem;\n\tborder-radius: var(--border-radius, 4px);\n\tborder: none;\n\tcursor: pointer;\n\tfont-size: 1rem;\n}\n.ereader-setup__btn.primary {\n\tbackground: var(--color-primary, #0082c9);\n\tcolor: #fff;\n}\n.ereader-setup__btn:disabled {\n\topacity: 0.6;\n\tcursor: not-allowed;\n}\n.ereader-setup__folders {\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0;\n}\n.ereader-setup__folder {\n\tmargin: 0.25rem 0;\n}\n.ereader-setup__folder-btn {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 0.5rem;\n\twidth: 100%;\n\ttext-align: left;\n\tpadding: 0.5rem 0.75rem;\n\tbackground: var(--color-background-hover, #f5f5f5);\n\tborder: none;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tfont-size: 1rem;\n}\n.ereader-setup__folder-btn:hover {\n\tbackground: var(--color-background-dark, #e5e5e5);\n}\n.ereader-setup__folder--root {\n\tmargin-bottom: 0.5rem;\n}\n.ereader-setup__folder-btn--root {\n\tbackground: var(--color-primary-light, #e6f4ff);\n\tcolor: var(--color-primary-text, #006aa3);\n\tfont-weight: 600;\n}\n.ereader-setup__folder-btn--root:hover {\n\tbackground: var(--color-primary-hover, #cce8ff);\n}\n.ereader-setup__folder-icon {\n\tfont-size: 1.2rem;\n}\n.ereader-setup__empty {\n\tcolor: var(--color-text-lighter, #666);\n\tpadding: 0.5rem 0;\n\tfont-size: 0.9rem;\n}\n.ereader-setup__loading,\n.ereader-setup__error {\n\tmargin: 1rem 0 0;\n}\n.ereader-setup__error {\n\tcolor: var(--color-error, #c00);\n}\n</style>\n"],sourceRoot:""}]);const d=s}}]);
//# sourceMappingURL=ereader-src_views_Setup_vue.js.map?v=3c5692cc0733724d86a8